import os
import numpy as np
from MachineLearningModule.DataAcquisition.ReadDatasetFromCSV import get_dataset_from_csv_file
from MachineLearningModule.MachineLearningFlow import data_pre_processing


def test_data_preprocessing_smoke():
    dataset_path = os.path.join('ProposedApproach', 'Datasets', 'Drebin_v1.csv')
    dataset, class_name = get_dataset_from_csv_file(dataset_path)
    x, y = data_pre_processing(dataset, class_name)
    # basic smoke checks
    assert x.shape[0] == y.shape[0]
    assert not x.isnull().any().any()


def test_model_file_exists():
    # check that a model file exists (either models/final_model.pkl or mlruns artifact)
    p1 = os.path.join('ProposedApproach','models','final_model.pkl')
    p2 = os.path.join('ProposedApproach','mlruns')
    assert os.path.exists(p1) or os.path.exists(p2)
